---
excalidraw-plugin: parsed
标签:
  - excalidraw
---
**MAE (Masked Autoencoder)**
- 架构：**Encoder + Decoder**，Encoder 是 [[Public/深度学习/Transformer]]
- 自监督方法：随机遮盖图像大块 patch，让模型预测被遮盖部分
- 学到的就是**图像的潜在表征**

==⚠  Switch to EXCALIDRAW VIEW in the MORE OPTIONS menu of this document. ⚠== You can decompress Drawing data with the command palette: 'Decompress current Excalidraw file'. For more info check in plugin settings under 'Saving'



## Text Elements
 Normalized Pixel Loss（像素归一化损失） ^tgDNJzu9

普通[[Loss Function#MSE]]损失：直接计算原始像素值的差异

归一化像素损失：先对像素值归一化，再计算差异 ^27kx5DPa

为什么需要像素归一化？
问题：像素值分布不均匀
图像像素值通常是0-255的整数，但：

不同图像的亮度、对比度差异大

像素值分布可能不均匀

直接计算MSE会让模型过度关注亮区域 ^TjyLfGXm

def norm_pix_loss(pred, target):
    # 1. 对每个patch的像素值进行归一化
    mean = target.mean(dim=-1, keepdim=True)
    var = target.var(dim=-1, keepdim=True)#方差计算
    eps = 1e-6
    
    # 2. 归一化目标像素值
    target_norm = (target - mean) / torch.sqrt(var + eps)#除以标准差
    
    # 3. 对预测值进行同样的归一化
    pred_norm = (pred - mean) / torch.sqrt(var + eps)
    
    # 4. 计算归一化后的MSE
    return torch.mean((pred_norm - target_norm) ** 2) ^g5g37NhP

在归一化时，所有数据应该使用相同的统计量（均值和方差）进行变换，这样才能保证它们在同一个尺度上比较。 ^zUHEL7lO


- 一句话：
- 关键：
- 误区：
- 例子：
- 链接：
%%
## Drawing
```compressed-json
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
```

%%

链接：[[20_Ref/深度学习基础理论/概念/MAE（Masked Autoencoder）]]






